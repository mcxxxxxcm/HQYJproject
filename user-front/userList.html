<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>用户列表</title>
		<script src="js/vue.js"></script>
		<script src="js/axios.min.js"></script>
		<script src="js/index.js"></script>
		<link href="css/index.css" rel="stylesheet" />
	</head>
	<body>
		<div id="userApp">
			<!-- 表格 -->
			<template>
				<el-table :data="userList" border style="width: 100%">
					<el-table-column fixed prop="id" label="序号">
					</el-table-column>
					<el-table-column prop="username" label="用户名">
					</el-table-column>
					<el-table-column prop="sex" label="性别">
					</el-table-column>
					<el-table-column prop="age" label="年龄">
					</el-table-column>
					<el-table-column prop="address" label="地址">
					</el-table-column>
					<el-table-column fixed="right" label="操作" width="100">
						<template slot-scope="scope">
							<el-button type="text" size="small">修改</el-button>
							<el-button type="text" size="small">删除</el-button>
						</template>
					</el-table-column>
				</el-table>
			</template>
			<!-- 分页 -->
			<!-- 
			 @size-change：当每页显示条数发生变化时触发的事件
			 @current-change：当页码发生变化时触发的事件
			 -->
			<el-pagination @size-change="handleSizeChange" @current-change="handleCurrentChange"
				:current-page="pageNumber" :page-sizes="[5, 10, 20, 50]" :page-size="pageSize"
				layout="total, sizes, prev, pager, next, jumper" :total="total">
			</el-pagination>
		</div>
	</body>

	<script>
		new Vue({
			el: "#userApp",
			data() {
				return {
					userList: [],
					pageNumber: 1,
					pageSize: 5,
					total: 0
				}
			},
			methods: {
				handleCurrentChange(val) {

				},
				handleSizeChange(val) {

				},
				getUserList() {
					//获取pageNumber和pageSize，封装成对象p
					let p = {};
					p.pageNumber = this.pageNumber;
					p.pageSize = this.pageSize;
					//axios发送请求，处理结果，发送get请求有格式
					axios.get('http://localhost:8088/user/page', {
							params: p
						})
						.then(result => {
							let data = result.data;
							console.log(data);
							this.total = data.data.total;
							this.userList = data.data.rows;
						})
				}
			},
			// 当页面加载完毕之后，自动触发的事件
			mounted() {
				this.getUserList();
			}
		})
	</script>
</html>
